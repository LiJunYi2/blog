---
title: JavaScriptæ ‘æ“ä½œæ–¹æ³•
date: 2021-10-16
sidebar: auto
categories:
 - å‰ç«¯
tags:
 - Tree
---

## æ•°ç»„æ‰å¹³åŒ–âœ¨

```javascript
const arr = [1, [2, [3, 4]], 5, [6]];
```

### æ–¹æ³•ğŸ‘‰

**1ã€é€’å½’**

```javascript
const flatten = (arr) => {
    let res = [];
    arr.map(item => {
        if(Array.isArray(item)) {
            res = res.concat(flatten(item));
        } else {
            res.push(item);
        }
    });
    return res;
}
```

**2ã€reduce**

```JavaScript
const flatten = (arr) => {
    return arr.reduce((result, item)=> {
        return result.concat(Array.isArray(item) ? flatten(item) : item);
    }, []);
}
```

**3ã€flat**

```javascript
const flatten = (arr) => {
    return arr.flat(Infinity)
}
```

### è¿è¡Œç»“æœğŸŸ

```JavaScript
const result = flatten(arr);
console.log(result);

// è¿è¡Œç»“æœ
[1, 2, 3, 4, 5, 6]
```

## æ•°ç»„è½¬æ ‘å½¢ç»“æ„âœ¨
**ç¤ºä¾‹**

```javascript
const arr = [
    {
        name: 'å°æ˜',
        id: 1,
        pid: 0,
    },
    {
        name: 'å°èŠ±',
        id: 11,
        pid: 1,
    },
    {
        name: 'å°å',
        id: 111,
        pid: 11,
    },
    {
        name: 'å°æ',
        id: 112,
        pid: 11,
    },
    {
        name: 'å°çº¢',
        id: 12,
        pid: 1,
    },
    {
        name: 'å°ç‹',
        id: 2,
        pid: 0,
    },
    {
        name: 'å°æ—',
        id: 21,
        pid: 2,
    },
    {
        name: 'å°æ',
        id: 22,
        pid: 2,
    }
]
```
### æ–¹æ³•ğŸ‘‰

**1ã€éé€’å½’**

```javascript
 const arrayToTree = (arr) => {
    let result = [];
    if (!Array.isArray(arr) || arr.length === 0) {
        return result
    }
    let map = {};
    arr.forEach(item => map[item.id] = item);
    arr.forEach(item => {
        const parent = map[item.pid];
        if(parent){
            (parent.children || (parent.children=[])).push(item);
        } else {
            result.push(item);
        }
    })
    return result
}
```

**2ã€é€’å½’**

```javascript
const arrayToTree = (arr, pid) => {
    let res = [];
    arr.forEach(item => {
        if(item.pid === pid){
            let itemChildren = arrayToTree(arr,item.id);
            if(itemChildren.length) {
                item.children = itemChildren;
            }
            res.push(item);
        }
    });
    return res;
}
```

### è¿è¡Œç»“æœğŸŸ

```javascript
// const result = arrayToTree(arr);
const result = arrayToTree(arr, 0);
console.log(result);

// è¿è¡Œç»“æœ
[
    {
        "name": "å°æ˜",
        "id": 1,
        "pid": 0,
        "children": [
            {
                "name": "å°èŠ±",
                "id": 11,
                "pid": 1,
                "children": [
                    {
                        "name": "å°å",
                        "id": 111,
                        "pid": 11
                    },
                    {
                        "name": "å°æ",
                        "id": 112,
                        "pid": 11
                    }
                ]
            },
            {
                "name": "å°çº¢",
                "id": 12,
                "pid": 1
            }
        ]
    },
    {
        "name": "å°ç‹",
        "id": 2,
        "pid": 0,
        "children": [
            {
                "name": "å°æ—",
                "id": 21,
                "pid": 2
            },
            {
                "name": "å°æ",
                "id": 22,
                "pid": 2
            }
        ]
    }
]
```

## æ ‘å½¢ç»“æ„è½¬æ•°ç»„ï¼ˆæ‰å¹³åŒ–ï¼‰âœ¨
**ç¤ºä¾‹**

```javascript
const tree = [
    {
        name: 'å°æ˜',
        id: 1,
        pid: 0,
        children: [
            {
                name: 'å°èŠ±',
                id: 11,
                pid: 1,
                children: [
                    {
                        name: 'å°å',
                        id: 111,
                        pid: 11,
                    },
                    {
                        name: 'å°æ',
                        id: 112,
                        pid: 11,
                    }
                ]
            },
            {
                name: 'å°çº¢',
                id: 12,
                pid: 1,
            }
        ]
    },
    {
        name: 'å°ç‹',
        id: 2,
        pid: 0,
        children: [
            {
                name: 'å°æ—',
                id: 21,
                pid: 2,
            },
            {
                name: 'å°æ',
                id: 22,
                pid: 2,
            }
        ]
    }
]
```

### æ–¹æ³•ğŸ‘‰

**1ã€æ·±åº¦ä¼˜å…ˆéå†**

```javascript
const treeToArray = (tree) => {
    let stack = tree,
        result = [];
    while(stack.length !== 0){
        let pop = stack.pop();
        result.push({
            id: pop.id,
            name: pop.name,
            pid: pop.pid
        })
        let children = pop.children
        if(children){
            for(let i = children.length-1; i >=0; i--){
                stack.push(children[i])
            }
        }
    }
    return result
}
```

**2ã€å¹¿åº¦ä¼˜å…ˆéå†**

```javascript
const treeToArray = (tree) => {
    let queue = tree,
        result = [];
    while(queue.length !== 0){
        let shift = queue.shift();
        result.push({
            id: shift.id,
            name: shift.name,
            pid: shift.pid
        })
        let children = shift.children
        if(children){
            for(let i = 0; i < children.length; i++){
                queue.push(children[i])
            }
        }
    }
    return result
}
```

**3ã€ä¸ç”¨è€ƒè™‘é™¤childrenå¤–çš„å…¶ä»–å±æ€§**

```javascript
const treeToArray = (source)=>{
    let res = []
    source.forEach(item=>{
        res.push(item)
        item.children && res.push(...treeToArray(item.children))
    })
    return res.map((item) => {
        if (item.children) {
            delete item.children
        }
        return item
    })
}
```

### è¿è¡Œç»“æœğŸŸ

```javascript
const result = treeToArray(tree);
console.log(result);

// è¿è¡Œç»“æœ
[
    {
        "name": "å°æ˜",
        "id": 1,
        "pid": 0
    },
    {
        "name": "å°èŠ±",
        "id": 11,
        "pid": 1
    },
    {
        "name": "å°å",
        "id": 111,
        "pid": 11
    },
    {
        "name": "å°æ",
        "id": 112,
        "pid": 11
    },
    {
        "name": "å°çº¢",
        "id": 12,
        "pid": 1
    },
    {
        "name": "å°ç‹",
        "id": 2,
        "pid": 0
    },
    {
        "name": "å°æ—",
        "id": 21,
        "pid": 2
    },
    {
        "name": "å°æ",
        "id": 22,
        "pid": 2
    }
]
```

## æ ‘ç­›é€‰ï¼Œä¿ç•™ç¬¦åˆæ¡ä»¶çš„æ•°æ®å¹¶è¿”å›æ ‘ç»“æ„âœ¨
**ç¤ºä¾‹**

```javascript
const tree = [
    {
        name: 'å°æ˜',
        id: 1,
        pid: 0,
        show: true,
        children: [
            {
                name: 'å°èŠ±',
                id: 11,
                pid: 1,
                show: true,
                children: [
                    {
                        name: 'å°å',
                        id: 111,
                        pid: 11,
                    },
                    {
                        name: 'å°æ',
                        id: 112,
                        pid: 11,
                        show: true,
                    }
                ]
            },
            {
                name: 'å°çº¢',
                id: 12,
                pid: 1,
            }
        ]
    },
    {
        name: 'å°ç‹',
        id: 2,
        pid: 0,
        show: true,
        children: [
            {
                name: 'å°æ—',
                id: 21,
                pid: 2,
            },
            {
                name: 'å°æ',
                id: 22,
                pid: 2,
            }
        ]
    }
]
```

### æ–¹æ³•ğŸ‘‰

**ç­›é€‰å‡ºshowä¸ºtrueæ•°æ®**

```javascript
const filterTreeByFunc = (tree, func) => {
    if (!Array.isArray(tree) || tree.length === 0) {
        return []
    }
    return tree.filter(item => {
        item.children = item.children && filterTreeByFunc(item.children, func)
        return func(item) || (item.children && item.children.length)
    })
}

const func = (item) => {
    return item.show === true
}

```

### è¿è¡Œç»“æœğŸŸ

```javascript
const result = filterTreeByFunc(tree, func);
console.log(result);

// è¿è¡Œç»“æœ
[
    {
        "name": "å°æ˜",
        "id": 1,
        "pid": 0,
        "show": true,
        "children": [
            {
                "name": "å°èŠ±",
                "id": 11,
                "pid": 1,
                "show": true,
                "children": [
                    {
                        "name": "å°æ",
                        "id": 112,
                        "pid": 11,
                        "show": true
                    }
                ]
            }
        ]
    },
    {
        "name": "å°ç‹",
        "id": 2,
        "pid": 0,
        "show": true,
        "children": []
    }
]

```

## æŸ¥æ‰¾æŸä¸€èŠ‚ç‚¹åœ¨æ ‘ä¸­è·¯å¾„âœ¨
**ç¤ºä¾‹**

```
const tree = [
    {
        name: 'å°æ˜',
        id: 1,
        pid: 0,
        children: [
            {
                name: 'å°èŠ±',
                id: 11,
                pid: 1,
                children: [
                    {
                        name: 'å°å',
                        id: 111,
                        pid: 11,
                    },
                    {
                        name: 'å°æ',
                        id: 112,
                        pid: 11,
                    }
                ]
            },
            {
                name: 'å°çº¢',
                id: 12,
                pid: 1,
            }
        ]
    },
    {
        name: 'å°ç‹',
        id: 2,
        pid: 0,
        children: [
            {
                name: 'å°æ—',
                id: 21,
                pid: 2,
            },
            {
                name: 'å°æ',
                id: 22,
                pid: 2,
            }
        ]
    }
]
```

### æ–¹æ³•ğŸ‘‰

```javascript
const getNodePath = (tree, id) => {
    if (!Array.isArray(tree) || tree.length === 0) {
        return []
    }
    const path = []
    const treeFindPath = (tree, id, path) => {
        for (const item of tree) {
            path.push(item.id);
            if (item.id === id) {
                return path
            }
            if (item.children) {
                const findChildren = treeFindPath(item.children,id, path);
                if (findChildren.length) {
                    return findChildren;
                }
            }
            path.pop();
        }
        return [];
    }
    return treeFindPath(tree, id, path)
}
```

### è¿è¡Œç»“æœğŸŸ

```javascript
const result = getNodePath(tree, 112);
console.log(result);

// è¿è¡Œç»“æœ
[1, 11, 112]

```

## æ¨¡ç³ŠæŸ¥è¯¢æ ‘âœ¨
**ç¤ºä¾‹**

```javascript
const tree = [
    {
        name: 'å°æ˜å‰ç«¯ä¸“å®¶',
        id: 1,
        pid: 0,
        children: [
            {
                name: 'å°èŠ±å‰ç«¯ç¨‹åºåª›',
                id: 11,
                pid: 1,
                children: [
                    {
                        name: 'å°ååˆ’æ°´è¿åŠ¨å‘˜',
                        id: 111,
                        pid: 11,
                    },
                    {
                        name: 'å°ææ‘¸é±¼è¿åŠ¨å‘˜',
                        id: 112,
                        pid: 11,
                    }
                ]
            },
            {
                name: 'å°çº¢æ‘¸é±¼ç¨‹åºå‘˜',
                id: 12,
                pid: 1,
            }
        ]
    },
    {
        name: 'å°ç‹å†…å·ç‹',
        id: 2,
        pid: 0,
        children: [
            {
                name: 'å°æ—æ‘¸é±¼ç‹',
                id: 21,
                pid: 2,
            },
            {
                name: 'å°æåç«¯ç¨‹åºå‘˜',
                id: 22,
                pid: 2,
            }
        ]
    }
]
```

### æ–¹æ³•ğŸ‘‰

```javascript
const fuzzyQueryTree = (arr, value) => {
    if (!Array.isArray(arr) || arr.length === 0) {
        return []
    }
    let result = [];
    arr.forEach(item => {
        if (item.name.indexOf(value) > -1) {
            const children = fuzzyQueryTree(item.children, value);
            const obj = { ...item, children }
            result.push(obj);
        } else {
            if (item.children && item.children.length > 0) {
                const children = fuzzyQueryTree(item.children, value);
                const obj = { ...item, children }
                if (children && children.length > 0) {
                    result.push(obj);
                }
            }
        }
    });
    return result;
};
```

### è¿è¡Œç»“æœğŸŸ

```javascript
const result = fuzzyQueryTree(tree,'ç¨‹åº');
console.log(result);

// è¿è¡Œç»“æœ
[
    {
        "name": "å°æ˜å‰ç«¯ä¸“å®¶",
        "id": 1,
        "pid": 0,
        "children": [
            {
                "name": "å°èŠ±å‰ç«¯ç¨‹åºåª›",
                "id": 11,
                "pid": 1,
                "children": []
            },
            {
                "name": "å°çº¢æ‘¸é±¼ç¨‹åºå‘˜",
                "id": 12,
                "pid": 1,
                "children": []
            }
        ]
    },
    {
        "name": "å°ç‹å†…å·ç‹",
        "id": 2,
        "pid": 0,
        "children": [
            {
                "name": "å°æåç«¯ç¨‹åºå‘˜",
                "id": 22,
                "pid": 2,
                "children": []
            }
        ]
    }
]
```

## æ ‘èŠ‚ç‚¹æ·»åŠ å±æ€§âœ¨
**ç¤ºä¾‹**

```javascript
const tree = [
    {
        name: 'å°æ˜',
        id: 1,
        pid: 0,
        children: [
            {
                name: 'å°èŠ±',
                id: 11,
                pid: 1,
                children: [
                    {
                        name: 'å°å',
                        id: 111,
                        pid: 11,
                    },
                    {
                        name: 'å°æ',
                        id: 112,
                        pid: 11,
                    }
                ]
            },
            {
                name: 'å°çº¢',
                id: 12,
                pid: 1,
            }
        ]
    },
    {
        name: 'å°ç‹',
        id: 2,
        pid: 0,
        children: [
            {
                name: 'å°æ—',
                id: 21,
                pid: 2,
            },
            {
                name: 'å°æ',
                id: 22,
                pid: 2,
            }
        ]
    }
]
```

### æ–¹æ³•ğŸ‘‰

```javascript
const addAttrToNodes = (tree) => {
    tree.forEach((item) => {
        item.title = 'æ–°ç”Ÿä»£å†œæ°‘å·¥'
        if (item.children && item.children.length > 0) {
            addAttrToNodes(item.children)
        }
    })
    return tree
}

```

### è¿è¡Œç»“æœğŸŸ

```javascript
const result = addAttrToNodes(tree);
console.log(result);

// è¿è¡Œç»“æœ
[
    {
        "name": "å°æ˜",
        "id": 1,
        "pid": 0,
        "children": [
            {
                "name": "å°èŠ±",
                "id": 11,
                "pid": 1,
                "children": [
                    {
                        "name": "å°å",
                        "id": 111,
                        "pid": 11,
                        "title": "æ–°ç”Ÿä»£å†œæ°‘å·¥"
                    },
                    {
                        "name": "å°æ",
                        "id": 112,
                        "pid": 11,
                        "title": "æ–°ç”Ÿä»£å†œæ°‘å·¥"
                    }
                ],
                "title": "æ–°ç”Ÿä»£å†œæ°‘å·¥"
            },
            {
                "name": "å°çº¢",
                "id": 12,
                "pid": 1,
                "title": "æ–°ç”Ÿä»£å†œæ°‘å·¥"
            }
        ],
        "title": "æ–°ç”Ÿä»£å†œæ°‘å·¥"
    },
    {
        "name": "å°ç‹",
        "id": 2,
        "pid": 0,
        "children": [
            {
                "name": "å°æ—",
                "id": 21,
                "pid": 2,
                "title": "æ–°ç”Ÿä»£å†œæ°‘å·¥"
            },
            {
                "name": "å°æ",
                "id": 22,
                "pid": 2,
                "title": "æ–°ç”Ÿä»£å†œæ°‘å·¥"
            }
        ],
        "title": "æ–°ç”Ÿä»£å†œæ°‘å·¥"
    }
]
```

## æ ‘èŠ‚ç‚¹åˆ é™¤å±æ€§âœ¨
**ç¤ºä¾‹**

```javascript
const tree = [
    {
        name: 'å°æ˜',
        id: 1,
        pid: 0,
        children: [
            {
                name: 'å°èŠ±',
                id: 11,
                pid: 1,
                children: [
                    {
                        name: 'å°å',
                        id: 111,
                        pid: 11,
                    },
                    {
                        name: 'å°æ',
                        id: 112,
                        pid: 11,
                    }
                ]
            },
            {
                name: 'å°çº¢',
                id: 12,
                pid: 1,
            }
        ]
    },
    {
        name: 'å°ç‹',
        id: 2,
        pid: 0,
        children: [
            {
                name: 'å°æ—',
                id: 21,
                pid: 2,
            },
            {
                name: 'å°æ',
                id: 22,
                pid: 2,
            }
        ]
    }
]
```

### æ–¹æ³•ğŸ‘‰

```javascript
const removeAttrFromNode = (tree) => {
    tree.forEach((item) => {
        delete item.title
        if (item.children && item.children.length > 0) {
            removeAttrFromNode(item.children)
        }
    })
    return tree
}
```

### è¿è¡Œç»“æœğŸŸ

```javascript
const result = removeAttrFromNode(tree);
console.log(result);

// è¿è¡Œç»“æœ
[
    {
        "name": "å°æ˜",
        "id": 1,
        "pid": 0,
        "children": [
            {
                "name": "å°èŠ±",
                "id": 11,
                "pid": 1,
                "children": [
                    {
                        "name": "å°å",
                        "id": 111,
                        "pid": 11
                    },
                    {
                        "name": "å°æ",
                        "id": 112,
                        "pid": 11
                    }
                ]
            },
            {
                "name": "å°çº¢",
                "id": 12,
                "pid": 1
            }
        ]
    },
    {
        "name": "å°ç‹",
        "id": 2,
        "pid": 0,
        "children": [
            {
                "name": "å°æ—",
                "id": 21,
                "pid": 2
            },
            {
                "name": "å°æ",
                "id": 22,
                "pid": 2
            }
        ]
    }
]
```

## åˆ é™¤æ ‘ä¸­çš„ç©ºchildrenâœ¨
**ç¤ºä¾‹**

```javascript
const tree = [
    {
        name: 'å°æ˜',
        id: 1,
        pid: 0,
        children: [
            {
                name: 'å°èŠ±',
                id: 11,
                pid: 1,
                children: [
                    {
                        name: 'å°å',
                        id: 111,
                        pid: 11,
                    },
                    {
                        name: 'å°æ',
                        id: 112,
                        pid: 11,
                        children: []
                    }
                ]
            },
            {
                name: 'å°çº¢',
                id: 12,
                pid: 1,
                children: []
            }
        ]
    },
    {
        name: 'å°ç‹',
        id: 2,
        pid: 0,
        children: [
            {
                name: 'å°æ—',
                id: 21,
                pid: 2,
            },
            {
                name: 'å°æ',
                id: 22,
                pid: 2,
                children: []
            }
        ]
    }
]
```

### æ–¹æ³•ğŸ‘‰

```javascript
const removeEmptyChildren = (tree) => {
    tree.forEach((item) => {
        if (item.children && item.children.length ===0) {
            delete item.children
        } else if (item.children && item.children.length > 0) {
            removeEmptyChildren(item.children)
        }
    })
    return tree
}
```

### è¿è¡Œç»“æœğŸŸ

```javascript
const result = removeEmptyChildren(tree);
console.log(result);

// è¿è¡Œç»“æœ
[
    {
        "name": "å°æ˜",
        "id": 1,
        "pid": 0,
        "children": [
            {
                "name": "å°èŠ±",
                "id": 11,
                "pid": 1,
                "children": [
                    {
                        "name": "å°å",
                        "id": 111,
                        "pid": 11
                    },
                    {
                        "name": "å°æ",
                        "id": 112,
                        "pid": 11
                    }
                ]
            },
            {
                "name": "å°çº¢",
                "id": 12,
                "pid": 1
            }
        ]
    },
    {
        "name": "å°ç‹",
        "id": 2,
        "pid": 0,
        "children": [
            {
                "name": "å°æ—",
                "id": 21,
                "pid": 2
            },
            {
                "name": "å°æ",
                "id": 22,
                "pid": 2
            }
        ]
    }
]
```

## è·å–æ ‘ä¸­æ‰€æœ‰çš„å¶å­èŠ‚ç‚¹âœ¨
**ç¤ºä¾‹**

```javascript
const tree = [
    {
        name: 'å°æ˜',
        id: 1,
        pid: 0,
        children: [
            {
                name: 'å°èŠ±',
                id: 11,
                pid: 1,
                children: [
                    {
                        name: 'å°å',
                        id: 111,
                        pid: 11,
                    },
                    {
                        name: 'å°æ',
                        id: 112,
                        pid: 11,
                    }
                ]
            },
            {
                name: 'å°çº¢',
                id: 12,
                pid: 1,
            }
        ]
    },
    {
        name: 'å°ç‹',
        id: 2,
        pid: 0,
        children: [
            {
                name: 'å°æ—',
                id: 21,
                pid: 2,
            },
            {
                name: 'å°æ',
                id: 22,
                pid: 2,
            }
        ]
    }
]
```

### æ–¹æ³•ğŸ‘‰

```javascript
const getAllLeaf = (tree) => {
    const result = []
    const getLeaf = (tree) => {
        tree.forEach((item) => {
            if (!item.children) {
                result.push(item)
            } else {
                getLeaf(item.children)
            }
        })
    }
    getLeaf(tree)
    return result
}
```

### è¿è¡Œç»“æœğŸŸ

```javascript
const result = getAllLeaf(tree);
console.log(result);

// è¿è¡Œç»“æœ
[
    {
        "name": "å°å",
        "id": 111,
        "pid": 11
    },
    {
        "name": "å°æ",
        "id": 112,
        "pid": 11
    },
    {
        "name": "å°çº¢",
        "id": 12,
        "pid": 1
    },
    {
        "name": "å°æ—",
        "id": 21,
        "pid": 2
    },
    {
        "name": "å°æ",
        "id": 22,
        "pid": 2
    }
]
```