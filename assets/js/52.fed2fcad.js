(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{581:function(s,a,t){"use strict";t.r(a);var n=t(2),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"nacos作为配置中心💥代码实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nacos作为配置中心💥代码实现"}},[s._v("#")]),s._v(" Nacos作为配置中心💥代码实现")]),s._v(" "),t("h3",{attrs:{id:"_1、引入依赖💨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、引入依赖💨"}},[s._v("#")]),s._v(" 1、引入依赖💨")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependencies")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--nacos-config--\x3e")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("com.alibaba.cloud"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-cloud-starter-alibaba-nacos-config"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--nacos-discovery--\x3e")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("com.alibaba.cloud"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-cloud-starter-alibaba-nacos-discovery"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--web + actuator--\x3e")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter-web"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter-actuator"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n   \n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependencies")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"},[s._v("YML的类别 💨")]),t("p",[s._v("Nacos同springcloud-config一样，在项目初始化时，要保证先从配置中心进行配置拉取，拉取配置之后，才能保证项目的正常启动。")]),s._v(" "),t("p",[s._v("springboot中配置文件的加载是存在优先级顺序的，bootstrap优先级高于application")])]),t("h3",{attrs:{id:"_2、配置bootstrap-yml💨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、配置bootstrap-yml💨"}},[s._v("#")]),s._v(" 2、配置Bootstrap.yml💨")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nacos配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3377")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nacos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("client\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nacos")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("discovery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server-addr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8848")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Nacos服务注册中心地址")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("config")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server-addr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8848")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Nacos作为配置中心地址")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("file-extension")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" yaml "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定yaml格式的配置")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("group")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TEST_GROUP\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ea7be215"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("37d0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("4175"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("958c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("a8af3545f115\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ${spring.application.name}-${spring.profile.active}.${spring.cloud.nacos.config.file-extension}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nacos-config-client-dev.yaml")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nacos-config-client-test.yaml   ----\x3e config.info")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("p",[t("strong",[s._v("共享配置 & 多配置文件")]),s._v("💨")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nacos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("multi\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("allow-bean-definition-overriding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nacos")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("nacos.username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("nacos.password"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("config")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server-addr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("nacos.server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("addr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("nacos.namespace"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用于共享的配置文件")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shared-configs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("data-id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" common"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mysql.yaml\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("group")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" SPRING_CLOUD_EXAMPLE_GROUP\n            \n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("data-id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" common"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("redis.yaml\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("group")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" SPRING_CLOUD_EXAMPLE_GROUP\n            \n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("data-id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" common"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("base.yaml\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("group")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" SPRING_CLOUD_EXAMPLE_GROUP\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 常规配置文件")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 优先级大于 shared-configs，在 shared-configs 之后加载")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("extension-configs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("data-id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nacos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("advanced.yaml\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("group")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" SPRING_CLOUD_EXAMPLE_GROUP\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("refresh")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("data-id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nacos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("base.yaml\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("group")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" SPRING_CLOUD_EXAMPLE_GROUP\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("refresh")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br")])]),t("h3",{attrs:{id:"_3、配置application-yml💨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、配置application-yml💨"}},[s._v("#")]),s._v(" 3、配置application.yml💨")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("profiles")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("active")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dev "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 表示开发环境")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#active: test # 表示测试环境")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#active: info")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_4、controller测试接口💨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、controller测试接口💨"}},[s._v("#")]),s._v(" 4、Controller测试接口💨")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * 配置客户端控制器\n *\n * @author LiJunYi\n * @date 2020/11/09\n * RefreshScope 支持Nacos的动态刷新功能\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RestController")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RefreshScope")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConfigClientController")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${config.info}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" configInfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/config/info"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getConfigInfo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" configInfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("h2",{attrs:{id:"在nacos中添加配置信息-重点-❗"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在nacos中添加配置信息-重点-❗"}},[s._v("#")]),s._v(" 在Nacos中添加配置信息（重点）❗")]),s._v(" "),t("h3",{attrs:{id:"匹配规则-理论💢"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#匹配规则-理论💢"}},[s._v("#")]),s._v(" 匹配规则-理论💢")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("Nacos")]),s._v("中的 "),t("strong",[s._v("Data Id")]),s._v(" 的组成格式及与SpringBoot配置文件中的匹配规则")]),s._v(" "),t("li",[t("a",{attrs:{href:"https://nacos.io/zh-cn/docs/quick-start-spring-cloud.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("strong",[s._v("说明：之所以需要配置spring.application.name，是因为它是构成Nacos配置管理dataId字段的一部分。")])])]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[t("span",{pre:!0,attrs:{class:"token title important"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v("  在Nacos Spring Cloud 中,dataId的完整格式如下:")]),s._v("\n${prefix}-${spring.profile.active}.${file-extension}\n  \n1、prefix 默认为 spring.application.name 的值，也可以通过配置项spring.cloud.nacos.config.prefix来配置。\n\n2、spring.profile.active即为当前环境对应的 profile。\n  注意:当spring.profile.active为空时，对应的连接符 – 也将不存在\n  datald的拼接格式变成${prefix}.${file-extension}\n\n3、file-exetension 为配置内容的数据格式，\n  可以通过配置项spring.cloud .nacos.config.file-extension来配置。\n  目前只支持properties和yaml类型。\n\n"),t("span",{pre:!0,attrs:{class:"token title important"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v("  通过Spring Cloud 原生注解@RefreshScope实现配置自动更新:")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token title important"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v(" 最后公式:")]),s._v("\n$(spring.application.name}-$(spring.profiles.active}.$spring.cloud.nacos.config.file-extension}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h3",{attrs:{id:"配置新增💦"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置新增💦"}},[s._v("#")]),s._v(" 配置新增💦")]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_6.png"),alt:"nacos_6"}})]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("图解")]),s._v("💨")])]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_7.png"),alt:"nacos_7"}})]),s._v(" "),t("h3",{attrs:{id:"分类配置💢"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分类配置💢"}},[s._v("#")]),s._v(" 分类配置💢")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("Nacos的图形化管理界面-配置管理")]),s._v("💨")])]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_8.png"),alt:"nacos_8"}})]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("命名空间")]),s._v("💨")])]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_9.png"),alt:"nacos_9"}})]),s._v(" "),t("h2",{attrs:{id:"namespace-group-data-ld三者关系-为什么这么设计-❗"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#namespace-group-data-ld三者关系-为什么这么设计-❗"}},[s._v("#")]),s._v(" Namespace+Group+ Data lD三者关系?为什么这么设计?❗")]),s._v(" "),t("h3",{attrs:{id:"是什么💨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#是什么💨"}},[s._v("#")]),s._v(" 是什么💨")]),s._v(" "),t("p",[s._v("类似Java里面的package名和类名， "),t("strong",[s._v("最外层的namespace是可以用于区分部署环境的，Group和DataID逻辑上区分两个目标对象。")])]),s._v(" "),t("h3",{attrs:{id:"三者情况💨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三者情况💨"}},[s._v("#")]),s._v(" 三者情况💨")]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_10.png"),alt:"nacos_10"}})]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[t("span",{pre:!0,attrs:{class:"token title important"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v(" 默认情况:")]),s._v("\n  Namespace=public，Group=DEFAULT_GROUP,默认Cluster是DEFAULT\n\n"),t("span",{pre:!0,attrs:{class:"token title important"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v(" Nacos默认的命名空间是public，Namespace主要用来实现隔离。")]),s._v("\n比方说我们现在有三个环境:开发、测试、生产环境，我们就可以创建三个Namespace，不同的Namespace之间是隔离的。\n\n"),t("span",{pre:!0,attrs:{class:"token title important"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v(" Group默认是DEFAULT_GROUP，Group可以把不同的微服务划分到同一个分组里面去")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token title important"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v(" Sevice就是微服务;一个Service可以包含多个Cluster(集群)，Nacos默认Cluster是DEFAULT，Cluster是对指定微服务的一个虚拟划分。")]),s._v("\n比方说为了容灾，将Service微服务分别部署在了杭州机房和广州机房，这时就可以给杭州机房的Service微服务起一个集群名称(Hz)，给广州机房的Service微服务起一个集群名称(GZ)，还可以尽量让同一个机房的微服务互相调用，以提升性能。\n\n"),t("span",{pre:!0,attrs:{class:"token title important"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v(" 最后是Instance，就是微服务的实例。")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h2",{attrs:{id:"实例-三种方案加载配置❗"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实例-三种方案加载配置❗"}},[s._v("#")]),s._v(" 实例-三种方案加载配置❗")]),s._v(" "),t("h3",{attrs:{id:"_1、dataid方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、dataid方案"}},[s._v("#")]),s._v(" 1、dataID方案")]),s._v(" "),t("p",[t("strong",[s._v("指定spring.profile.active和配置文件的DatalD来使不同环境下读取不同的配置")])]),s._v(" "),t("p",[t("strong",[s._v("默认空间+默认分组+新建dev和test两个DatalD")])]),s._v(" "),t("p",[t("strong",[s._v("通过spring.profile.active属性就能进行多环境下配置文件的读取")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("新建两个不同的配置")]),s._v("💨")])]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_11.png"),alt:"nacos_11"}})]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("YML")]),s._v("💨")])]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_12.png"),alt:"nacos_12"}})]),s._v(" "),t("h3",{attrs:{id:"_2、group方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、group方案"}},[s._v("#")]),s._v(" 2、Group方案")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("Nacos配置详情")]),s._v("💨")])]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_13.png"),alt:"nacos_13"}})]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("YML")]),s._v("💨")])]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_14.png"),alt:"nacos_14"}})]),t("p"),t("h3",{attrs:{id:"_3、namespace方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、namespace方案"}},[s._v("#")]),s._v(" 3、Namespace方案")]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_15.png"),alt:"nacos_15"}})]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("Nacos新增命名空间")]),s._v("💨")])]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_16.png"),alt:"nacos_16"}})]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_17.png"),alt:"nacos_17"}})]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("bootstrao.yml")]),s._v("💨")])]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nacos配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3377")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nacos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("client\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nacos")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("discovery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server-addr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8848")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Nacos服务注册中心地址")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("config")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server-addr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8848")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Nacos作为配置中心地址")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("file-extension")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" yaml "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定yaml格式的配置")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("group")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TEST_GROUP\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ea7be215"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("37d0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("4175"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("958c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("a8af3545f115\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h2",{attrs:{id:"nacos集群和持久化配置-重点-❗❗"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nacos集群和持久化配置-重点-❗❗"}},[s._v("#")]),s._v(" Nacos集群和持久化配置(重点)❗❗")]),s._v(" "),t("h3",{attrs:{id:"官方架构图💨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#官方架构图💨"}},[s._v("#")]),s._v(" 官方架构图💨")]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_18.png"),alt:"nacos_18"}})]),s._v(" "),t("h3",{attrs:{id:"说明💨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#说明💨"}},[s._v("#")]),s._v(" 说明💨")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[t("strong",[s._v("默认Nacos使用嵌入式数据库实现数据的存储。所以，如果启动多个默认配置下的Nacos节点，数据存储是存在一致性问题的。为了解决这个问题，Nacos采用了集中式存储的方式来支持集群化部署，目前只支持MySQL的存储。")])])]),t("h3",{attrs:{id:"nacos支持三种部署模式🕳"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nacos支持三种部署模式🕳"}},[s._v("#")]),s._v(" Nacos支持三种部署模式🕳")]),s._v(" "),t("ul",[t("li",[s._v("单机模式-用于测试和单机试用。")]),s._v(" "),t("li",[s._v("集群模式–用于生产环境，确保高可用。")]),s._v(" "),t("li",[s._v("多集群模式-用于多数据中心场景。")])]),s._v(" "),t("h2",{attrs:{id:"单机模式支持mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#单机模式支持mysql"}},[s._v("#")]),s._v(" 单机模式支持mysql")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("在0.7版本之前，在单机模式时nacos使用嵌入式数据库实现数据的存储，不方便观察数据存储的基本情况。0.7版本增加了支持mysql数据源能力，具体的操作步骤:\n    \n1.安装数据库，版本要求:5.6.5+\n2.初始化mysql数据库，数据库初始化文件: nacos-mysql.sql\n3.修改conf/application.properties文件，增加支持mysql数据源配置(目前只支持mysql)，添加mysql数据源的url、用户名和密码。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[s._v("spring.datasource.platform=mysql\n\ndb.num=1\ndb.ur1.0=jdbc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//11.162.196.16"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3306/nacos_devtest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("characterEncoding=utf8"),t("span",{pre:!0,attrs:{class:"token important"}},[s._v("&connectTimeout=1006")]),s._v("\ndb.user=nacos_devtest\ndb.password=youdontknow\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("再以单机模式启动nacos，nacos所有写嵌入式数据库的数据都写到了mysql")]),s._v(" "),t("h2",{attrs:{id:"集群模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#集群模式"}},[s._v("#")]),s._v(" 集群模式")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("Nacos持久化配置解释")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("Nacos默认自带的是嵌入式数据库derby")])]),s._v(" "),t("li",[t("strong",[s._v("derby到mysql切换配置步骤")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("1、nacos-server-1.1.4\\nacos\\conf录下找到sql脚本 -> nacos-mysql.sql 执行脚本")])]),s._v(" "),t("li",[t("strong",[s._v("2、nacos-server-1.1.4\\nacos\\conf录下找到application.properties")])])])]),s._v(" "),t("li",[t("strong",[s._v("启动Nacos，可以看到是个全新的空记录界面，以前是记录进derby")])])])])]),s._v(" "),t("h2",{attrs:{id:"linux版本nacos-mysql生产环境配置-集群-❗❗"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux版本nacos-mysql生产环境配置-集群-❗❗"}},[s._v("#")]),s._v(" Linux版本Nacos+Mysql生产环境配置（集群）❗❗")]),s._v(" "),t("h3",{attrs:{id:"_1、前期准备"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、前期准备"}},[s._v("#")]),s._v(" 1、前期准备")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.yuque.com/attachments/yuque/0/2021/zip/1108138/1628843053288-3410a865-3795-408b-a385-c156bc697d9d.zip?_lake_card=%7B%22src%22%3A%22https%3A%2F%2Fwww.yuque.com%2Fattachments%2Fyuque%2F0%2F2021%2Fzip%2F1108138%2F1628843053288-3410a865-3795-408b-a385-c156bc697d9d.zip%22%2C%22name%22%3A%22nacos-linux%E4%B8%8A%E9%85%8D%E7%BD%AE.zip%22%2C%22size%22%3A53033045%2C%22type%22%3A%22%22%2C%22ext%22%3A%22zip%22%2C%22status%22%3A%22done%22%2C%22source%22%3A%22transfer%22%2C%22id%22%3A%22XFJw4%22%2C%22card%22%3A%22file%22%7D",target:"_blank",rel:"noopener noreferrer"}},[s._v("nacos-linux上配置.zip"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("1个Nginx + 3个Nacos（linux版本） + 1个Mysql（mysql5.7）")]),s._v(" "),t("h3",{attrs:{id:"_2、linux上的mysql建库-导入脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、linux上的mysql建库-导入脚本"}},[s._v("#")]),s._v(" 2、linux上的mysql建库，导入脚本")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("G:\\java\\SpringCloud2020\\nacos\\nacos\\conf\\nacos-mysql.sql\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_3、修改application-properties"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、修改application-properties"}},[s._v("#")]),s._v(" 3、修改application.properties")]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_19.png"),alt:"nacos_19"}})]),s._v(" "),t("h3",{attrs:{id:"_4、linux服务器上nacos的集群配置cluster-conf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、linux服务器上nacos的集群配置cluster-conf"}},[s._v("#")]),s._v(" 4、Linux服务器上nacos的集群配置cluster.conf")]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_20.png"),alt:"nacos_20"}})]),t("p"),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_21.png"),alt:"nacos_21"}})]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_22.png"),alt:"nacos_22"}})]),s._v(" "),t("h3",{attrs:{id:"_5、编辑nacos的启动脚本startup-sh-使他能接收不同的启动端口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5、编辑nacos的启动脚本startup-sh-使他能接收不同的启动端口"}},[s._v("#")]),s._v(" 5、编辑Nacos的启动脚本startup.sh，使他能接收不同的启动端口")]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_23.png"),alt:"nacos_23"}})]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_24.png"),alt:"nacos_24"}})]),s._v(" "),t("p",[t("strong",[s._v("（清晰图-修改后的startup.sh）")])]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_25.png"),alt:"nacos_25"}})]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_26.png"),alt:"nacos_26"}})]),s._v(" "),t("h3",{attrs:{id:"_6、nginx的配置-由它作负载均衡nginx-linux上配置-zip"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6、nginx的配置-由它作负载均衡nginx-linux上配置-zip"}},[s._v("#")]),s._v(" 6、Nginx的配置，由它作负载均衡"),t("a",{attrs:{href:"https://www.yuque.com/attachments/yuque/0/2021/zip/1108138/1628843053385-05193a95-b088-44bf-b599-08328e2c0366.zip?_lake_card=%7B%22src%22%3A%22https%3A%2F%2Fwww.yuque.com%2Fattachments%2Fyuque%2F0%2F2021%2Fzip%2F1108138%2F1628843053385-05193a95-b088-44bf-b599-08328e2c0366.zip%22%2C%22name%22%3A%22nginx-linux%E4%B8%8A%E9%85%8D%E7%BD%AE.zip%22%2C%22size%22%3A1491917%2C%22type%22%3A%22%22%2C%22ext%22%3A%22zip%22%2C%22status%22%3A%22done%22%2C%22source%22%3A%22transfer%22%2C%22id%22%3A%22jBjen%22%2C%22card%22%3A%22file%22%7D",target:"_blank",rel:"noopener noreferrer"}},[s._v("nginx-linux上配置.zip"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_27.png"),alt:"nacos_27"}})]),s._v(" "),t("h2",{attrs:{id:"集群搭建完成💫"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#集群搭建完成💫"}},[s._v("#")]),s._v(" 集群搭建完成💫")]),s._v(" "),t("h3",{attrs:{id:"启动nacos-💨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动nacos-💨"}},[s._v("#")]),s._v(" 启动nacos 💨")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("./startup.sh -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3333")]),s._v("\n./startup.sh -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4444")]),s._v("\n./startup.sh -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5555")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"查看nacos启动的个数-💨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看nacos启动的个数-💨"}},[s._v("#")]),s._v(" 查看nacos启动的个数：💨")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" nacos"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -v "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"通过nginx访问nacos-💨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#通过nginx访问nacos-💨"}},[s._v("#")]),s._v(" 通过nginx访问nacos：💨")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("http://192.168.111.144:1111/nacos/#/login\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"yml修改配置-示例用9002-💨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#yml修改配置-示例用9002-💨"}},[s._v("#")]),s._v(" yml修改配置(示例用9002)：💨")]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_28.png"),alt:"nacos_28"}})]),s._v(" "),t("h2",{attrs:{id:"高可用小总结⭕"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#高可用小总结⭕"}},[s._v("#")]),s._v(" 高可用小总结⭕")]),s._v(" "),t("p",[t("img",{staticClass:"medium-zoom-image",attrs:{src:s.$withBase("/SpringCloud/nacos_29.png"),alt:"nacos_29"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);